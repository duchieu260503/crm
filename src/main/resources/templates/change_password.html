<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorator="layout">

<body>
<section layout:fragment="content">

    <!-- Breadcrumb and Page Title Section -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-4">
        <h1 class="text-2xl font-bold flex items-center gap-2 text-gray-700 mb-4 sm:mb-0">
            <i class="fa fa-dashboard text-viettel-red"></i> Đổi mật khẩu
        </h1>
    </div>

    <!-- Main Content Area: Change Password Form Card -->
    <div class="bg-white shadow rounded-lg p-6 max-w-4xl mx-auto mt-8">
        <h3 class="text-lg font-semibold mb-4 text-gray-800 border-b pb-2">Đổi mật khẩu</h3>
        <form id="changePasswordForm" class="space-y-4">
            <!-- Old Password Field -->
            <div class="mb-4">
                <label for="oldPassword" class="block text-gray-700 text-sm font-bold mb-2">Mật khẩu cũ:</label>
                <div class="relative">
                    <input class="block w-full border border-gray-300 rounded-md px-3 py-2 pr-10 focus:ring-viettel-red focus:border-viettel-red transition-colors duration-200"
                           type="password" id="oldPassword" name="oldPassword" required="required"
                           placeholder="Nhập mật khẩu cũ của bạn"/>
                    <i class="fas fa-eye toggle-password absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer text-gray-500 hover:text-gray-700"
                       id="toggleOldPassword"></i>
                </div>
            </div>

            <!-- New Password Field -->
            <div class="mb-4">
                <label for="newPassword" class="block text-gray-700 text-sm font-bold mb-2">Mật khẩu mới:</label>
                <div class="relative">
                    <input class="block w-full border border-gray-300 rounded-md px-3 py-2 pr-10 focus:ring-viettel-red focus:border-viettel-red transition-colors duration-200"
                           type="password" id="newPassword" name="newPassword" required="required"
                           placeholder="Nhập mật khẩu mới của bạn"/>
                    <i class="fas fa-eye toggle-password absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer text-gray-500 hover:text-gray-700"
                       id="toggleNewPassword"></i>
                </div>
            </div>

            <!-- Confirm New Password Field -->
            <div class="mb-6">
                <label for="confirmPassword" class="block text-gray-700 text-sm font-bold mb-2">Xác nhận mật khẩu
                    mới:</label>
                <div class="relative">
                    <input class="block w-full border border-gray-300 rounded-md px-3 py-2 pr-10 focus:ring-viettel-red focus:border-viettel-red transition-colors duration-200"
                           type="password" id="confirmPassword" name="confirmPassword" required="required"
                           placeholder="Xác nhận mật khẩu mới của bạn"/>
                    <i class="fas fa-eye toggle-password absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer text-gray-500 hover:text-gray-700"
                       id="toggleConfirmPassword"></i>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="flex justify-end pt-4">
                <button type="submit"
                        class="bg-viettel-red hover:bg-viettel-red-dark text-white font-bold px-6 py-2 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-viettel-red focus:ring-opacity-50">
                    Đổi mật khẩu
                </button>
            </div>

            <!-- Message Display Area -->
            <div id="message" class="mt-4 p-3 text-sm rounded-md hidden"></div>
        </form>
    </div>

</section>

<!-- JavaScript for Password Toggling -->
<script th:inline="javascript">
    document.addEventListener('DOMContentLoaded', function () {
        console.log('[DOM Ready] Initializing password toggle icons.');

        function setupPasswordToggle(toggleId, fieldId) {
            const toggle = document.getElementById(toggleId);
            const field = document.getElementById(fieldId);

            if (!toggle) {
                console.warn(`[Toggle Missing] No element with ID '${toggleId}' found.`);
                return;
            }

            if (!field) {
                console.warn(`[Field Missing] No element with ID '${fieldId}' found.`);
                return;
            }

            toggle.addEventListener('click', function () {
                const isPassword = field.getAttribute('type') === 'password';
                field.setAttribute('type', isPassword ? 'text' : 'password');

                // Toggle FontAwesome eye icon
                this.classList.toggle('fa-eye');
                this.classList.toggle('fa-eye-slash');

                console.log(`[Toggle] ${fieldId} is now ${isPassword ? 'visible' : 'hidden'}`);
            });
        }

        // Set up all three toggles
        setupPasswordToggle('toggleOldPassword', 'oldPassword');
        setupPasswordToggle('toggleNewPassword', 'newPassword');
        setupPasswordToggle('toggleConfirmPassword', 'confirmPassword');
    });
</script>


</body>
</html>
